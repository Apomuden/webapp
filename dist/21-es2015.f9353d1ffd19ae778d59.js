(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{Hg4z:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("jtHE"),n=i("1G5W");function r(e){return function(t){return t.pipe(Object(n.a)(function(e){var t=e;if(t.__componentDestroyed$)return t.__componentDestroyed$;var i=e.ngOnDestroy,n=new s.a;return t.ngOnDestroy=function(){i&&i.apply(e),n.next(!0),n.complete()},t.__componentDestroyed$=n.asObservable()}(e)))}}},szcd:function(e,t,i){"use strict";i.r(t);var s=i("8Y7J");class n{}var r=i("pMnS"),o=i("s7LF"),a=i("Kj3r"),d=i("SxV6"),c=i("B3wD"),l=i("2Vo4"),p=i("Hg4z"),m=i("3S7Z"),h=i("NAv5"),u=i("SVse");class b{constructor(e,t,i,s){this.fb=e,this.recordService=t,this.notificationS=i,this.setupService=s,this.requestForm=this.fb.group({folderNumber:this.fb.control(null,[o.t.minLength(11),o.t.maxLength(12)]),attendanceDate:this.fb.control(new Date,[o.t.required]),clinic:this.fb.control(null,[o.t.required]),consultationService:this.fb.control(null,[o.t.required]),orderType:this.fb.control("INTERNAL",[o.t.required]),billed:this.fb.control(0,[o.t.required]),ccc:this.fb.control(null,[o.t.minLength(5),o.t.maxLength(5)]),qty:this.fb.control({value:1,disabled:!0},[o.t.required,o.t.min(1)]),fee:this.fb.control({value:0,disabled:!0},[o.t.required,o.t.min(.1)])}),this.clinicsloading=new l.a(!1),this.servicesLoading=new l.a(!1),this.sponsorLoading=!1,this.isLoadingData=!1,this.searchInitialized=!1,this.requesting=!1,this.clinics=[],this.services=[],this.message="Please enter a valid folder number to fill this form.",this.patientSponsor={billing_sponsor_name:"Patient",id:0,card_serial_no:null,member_id:null,staff_id:null,billing_sponsor:{id:0,sponsorship_type_name:"Patient"}},this.sponsorPermits=[this.patientSponsor],this.ageUnit="year(s)",this.formatFee=e=>`GHC ${e}`,this.parseFee=e=>e.replace("GHC","")}ngOnInit(){}ngAfterViewInit(){this.folderNoControl.valueChanges.pipe(Object(a.a)(1e3),Object(p.a)(this)).subscribe(e=>{e&&this.folderNoControl.valid?this.getPatient(e):(this.message="Please enter a valid folder number to fill this form.",this.searchInitialized=!1)}),this.clinicControl.valueChanges.pipe(Object(p.a)(this)).subscribe(e=>{this.getClinicServices(e)}),this.billedControl.valueChanges.pipe(Object(p.a)(this)).subscribe(e=>{this.setPrice()}),this.serviceControl.valueChanges.pipe(Object(p.a)(this)).subscribe(e=>{e&&this.getPrice(e)})}ngOnDestroy(){}get folderNoControl(){return this.requestForm.get("folderNumber")}get feeControl(){return this.requestForm.get("fee")}get qtyControl(){return this.requestForm.get("qty")}get clinicControl(){return this.requestForm.get("clinic")}get serviceControl(){return this.requestForm.get("consultationService")}get billedControl(){return this.requestForm.get("billed")}get cccControl(){return this.requestForm.get("ccc")}get attendanceDateControl(){return this.requestForm.get("attendanceDate")}get isInsurance(){const e=this.getSelectedSponsorPermit(this.billedControl.value);return e&&"government insurance"===e.billing_sponsor.sponsorship_type_name.toLocaleLowerCase()?(this.cccControl.setValidators([o.t.required,o.t.minLength(5),o.t.maxLength(5)]),this.cccControl.enable(),!0):(this.cccControl.disable(),this.cccControl.reset(),this.cccControl.clearValidators(),!1)}get isCash(){const e=this.getSelectedSponsorPermit(this.billedControl.value);return!!e&&"patient"===e.billing_sponsor.sponsorship_type_name.toLocaleLowerCase()}getSelectedSponsorPermit(e){const t=this.sponsorPermits.find(t=>t.id===e);return this.permit=t,t||null}getPatient(e){this.isLoadingData=!0,this.searchInitialized=!0,this.recordService.getAllPatients(`/single?folder_no=${e}`).pipe(Object(d.a)()).subscribe(e=>{this.isLoadingData=!1,e.data?(this.patient=e.data,this.appendToForm(),this.getPatientSponsorPermits(this.patient.id),this.getClinics()):(this.message="Folder not found",this.searchInitialized=!1)},e=>{this.message="Folder not found",this.searchInitialized=!1})}disabledDate(e){return!!e&&h.isAfter(e,new Date)}getPatientSponsorPermits(e){this.sponsorLoading=!0,this.recordService.getPatientSponsors(e).pipe(Object(d.a)()).subscribe(e=>{e&&e.data&&this.sponsorPermits.push(...e.data),this.sponsorLoading=!1},e=>{})}getClinics(){this.clinicsloading.next(!0),this.setupService.getClinics().pipe(Object(d.a)()).subscribe(e=>{this.clinics=e.data,this.clinicsloading.next(!1)},e=>{this.clinicsloading.next(!1)})}getClinicServices(e){this.servicesLoading.next(!0),this.setupService.getServicesByClinic(e).pipe(Object(d.a)()).subscribe(e=>{this.services=e.data,this.servicesLoading.next(!1)},e=>{this.servicesLoading.next(!1)})}getPrice(e){this.requesting=!0,this.setupService.getServicePrice(e).pipe(Object(d.a)()).subscribe(e=>{this.servicePrice=e,this.requesting=!1,this.setPrice()})}setPrice(){this.servicePrice&&this.feeControl.patchValue(this.isCash?this.servicePrice.prepaid_amount:this.servicePrice.postpaid_amount)}compareFn(e,t){return e===t}appendToForm(){let e=h.differenceInCalendarYears(new Date,new Date(this.patient.dob));e<1&&(e=h.differenceInMonths(new Date,new Date(this.patient.dob)),this.ageUnit="month(s)",e<1&&(e=h.differenceInCalendarDays(new Date,new Date(this.patient.dob)),this.ageUnit="day(s)")),this.patient.age=e,"Patient"!==this.patient.sponsorship_type_name&&this.billedControl.reset()}cancel(){this.patient=null,this.sponsorPermits=[this.patientSponsor],this.searchInitialized=!1,this.requestForm.reset(),this.requestForm.get("orderType").setValue("INTERNAL"),this.billedControl.setValue(0),this.feeControl.setValue(0),this.qtyControl.setValue(1),this.attendanceDateControl.setValue(new Date)}validateForm(){if(this.requestForm.valid)return!0;for(const e of Object.keys(this.requestForm.controls))this.requestForm.controls[e].invalid&&(this.requestForm.controls[e].markAsDirty(),this.requestForm.controls[e].updateValueAndValidity());return this.requestForm.valid}done(){this.validateForm()&&this.submitForm()}submitForm(){this.requesting=!0;const e=this.processData();this.recordService.requestConsultation(e).subscribe(e=>{this.requesting=!1,this.notificationS.success("Success",`Successfully requested consultation for ${this.patient.folder_no}`),this.cancel()},e=>{console.log(e),this.requesting=!1,this.notificationS.error("Oops",`Failed to request consultation for ${this.patient.folder_no}. Consultation has probably been requested already.`)})}processData(){return{order_type:this.requestForm.get("orderType").value,service_quantity:this.qtyControl.value,service_fee:this.feeControl.value,age:h.differenceInCalendarYears(new Date,new Date(this.patient.dob)),patient_id:this.patient.id,clinic_id:this.clinicControl.value,consultation_service_id:this.serviceControl.value,funding_type_id:this.patient.funding_type_id,sponsorship_type:this.permit.billing_sponsor.sponsorship_type_name,ccc:this.cccControl.value,patient_status:this.patient.reg_status,patient_sponsor_id:0===this.billedControl.value?null:this.billedControl.value,billing_sponsor_id:0===this.billedControl.value?null:this.getSelectedSponsorPermit(this.billedControl.value).billing_sponsor.id,attendance_date:Object(u.B)(this.attendanceDateControl.value,"yyyy-MM-dd HH:mm:ss","en"),card_serial_no:this.permit.card_serial_no,member_id:this.permit.member_id,staff_id:this.permit.staff_id}}}var g=i("0CZq"),f=s["\u0275crt"]({encapsulation:0,styles:[[""]],data:{}});function v(e){return s["\u0275vid"](0,[(e()(),s["\u0275ted"](-1,null,["\nWork in progress\n"]))],null,null)}function C(e){return s["\u0275vid"](0,[(e()(),s["\u0275eld"](0,0,null,null,1,"app-receipt",[],null,null,null,v,f)),s["\u0275did"](1,4440064,null,0,b,[o.e,m.a,g.f,c.a],null,null)],(function(e,t){e(t,1,0)}),null)}var _=s["\u0275ccf"]("app-receipt",b,C,{},{},[]),y=i("EdU/"),q=i("/Yna"),S=i("JRKe"),F=i("Ed4d"),P=i("8WaK"),D=i("QfCi"),z=i("CghO"),w=i("Sq/J"),L=i("5VGP"),O=i("QQfA"),I=i("IP0z"),N=i("POq0"),j=i("PQ0Y"),A=i("iInd"),V=i("eRTK");const x={title:"Receipts"};class R{}var T=i("/HVE"),k=i("v1Dh"),H=i("66zS"),M=i("5Izy"),B=i("yTpB"),E=i("zMNK"),G=i("hOhj"),J=i("r19J"),Y=i("anqq"),K=i("IYs4"),Q=i("EcpC"),Z=i("GaVp"),$=i("/L1H"),W=i("phDe"),U=i("rJp6"),X=i("Rgb0"),ee=i("kS4m"),te=i("mW00"),ie=i("jTf7"),se=i("WPSl"),ne=i("YdS3"),re=i("wQFA"),oe=i("px0D"),ae=i("3ZFI"),de=i("CYS+"),ce=i("oBm0"),le=i("A7zk"),pe=i("YRt3"),me=i("lAiz"),he=i("ce6n"),ue=i("SBNi"),be=i("iC8E"),ge=i("7QIX"),fe=i("tYkK"),ve=i("wf2+"),Ce=i("eCGT"),_e=i("nHXS"),ye=i("fb/r"),qe=i("zTFG"),Se=i("JK0T"),Fe=i("JXeA"),Pe=i("NFMk"),De=i("qU0y"),ze=i("vZsH"),we=i("W4B1"),Le=i("SHEi"),Oe=i("FPpa"),Ie=i("RVNi"),Ne=i("NDed"),je=i("5A4h"),Ae=i("N2O2"),Ve=i("ozKM"),xe=i("OvZZ"),Re=i("z+yo"),Te=i("DQmg"),ke=i("haRT"),He=i("1+nf"),Me=i("XFzh"),Be=i("p+Sl"),Ee=i("HhpN"),Ge=i("SN7N"),Je=i("fwnu"),Ye=i("VbP7"),Ke=i("gaRz"),Qe=i("e15G"),Ze=i("1v46"),$e=i("wjv3"),We=i("bse0"),Ue=i("PCNd");i.d(t,"AccountsModuleNgFactory",(function(){return Xe}));var Xe=s["\u0275cmf"](n,[],(function(e){return s["\u0275mod"]([s["\u0275mpd"](512,s.ComponentFactoryResolver,s["\u0275CodegenComponentFactoryResolver"],[[8,[r.a,_,y.a,y.b,q.a,S.a,F.a,P.a,D.a,z.a,w.a]],[3,s.ComponentFactoryResolver],s.NgModuleRef]),s["\u0275mpd"](4608,u.p,u.o,[s.LOCALE_ID,[2,u.L]]),s["\u0275mpd"](5120,L.x,L.J,[u.d,[3,L.x]]),s["\u0275mpd"](4608,O.d,O.d,[O.k,O.f,s.ComponentFactoryResolver,O.i,O.g,s.Injector,s.NgZone,u.d,I.b,[2,u.i]]),s["\u0275mpd"](5120,O.l,O.m,[O.d]),s["\u0275mpd"](4608,o.v,o.v,[]),s["\u0275mpd"](4608,N.c,N.c,[]),s["\u0275mpd"](4608,o.e,o.e,[]),s["\u0275mpd"](4608,j.a,j.a,[]),s["\u0275mpd"](4608,g.f,g.f,[L.y,O.d,s.Injector,s.ComponentFactoryResolver,s.ApplicationRef]),s["\u0275mpd"](1073742336,u.c,u.c,[]),s["\u0275mpd"](1073742336,A.q,A.q,[[2,A.v],[2,A.m]]),s["\u0275mpd"](1073742336,R,R,[]),s["\u0275mpd"](1073742336,T.b,T.b,[]),s["\u0275mpd"](1073742336,k.a,k.a,[]),s["\u0275mpd"](1073742336,H.b,H.b,[]),s["\u0275mpd"](1073742336,L.j,L.j,[]),s["\u0275mpd"](1073742336,M.b,M.b,[]),s["\u0275mpd"](1073742336,B.a,B.a,[]),s["\u0275mpd"](1073742336,I.a,I.a,[]),s["\u0275mpd"](1073742336,E.e,E.e,[]),s["\u0275mpd"](1073742336,G.g,G.g,[]),s["\u0275mpd"](1073742336,O.h,O.h,[]),s["\u0275mpd"](1073742336,o.u,o.u,[]),s["\u0275mpd"](1073742336,o.k,o.k,[]),s["\u0275mpd"](1073742336,L.u,L.u,[]),s["\u0275mpd"](1073742336,J.a,J.a,[]),s["\u0275mpd"](1073742336,Y.b,Y.b,[]),s["\u0275mpd"](1073742336,K.a,K.a,[]),s["\u0275mpd"](1073742336,N.d,N.d,[]),s["\u0275mpd"](1073742336,Q.a,Q.a,[]),s["\u0275mpd"](1073742336,L.G,L.G,[]),s["\u0275mpd"](1073742336,Z.c,Z.c,[]),s["\u0275mpd"](1073742336,L.v,L.v,[]),s["\u0275mpd"](1073742336,$.c,$.c,[]),s["\u0275mpd"](1073742336,W.h,W.h,[]),s["\u0275mpd"](1073742336,W.a,W.a,[]),s["\u0275mpd"](1073742336,W.e,W.e,[]),s["\u0275mpd"](1073742336,U.c,U.c,[]),s["\u0275mpd"](1073742336,X.c,X.c,[]),s["\u0275mpd"](1073742336,ee.d,ee.d,[]),s["\u0275mpd"](1073742336,te.c,te.c,[]),s["\u0275mpd"](1073742336,ie.h,ie.h,[]),s["\u0275mpd"](1073742336,se.f,se.f,[]),s["\u0275mpd"](1073742336,ne.d,ne.d,[]),s["\u0275mpd"](1073742336,re.a,re.a,[]),s["\u0275mpd"](1073742336,L.r,L.r,[]),s["\u0275mpd"](1073742336,oe.d,oe.d,[]),s["\u0275mpd"](1073742336,ae.a,ae.a,[]),s["\u0275mpd"](1073742336,de.c,de.c,[]),s["\u0275mpd"](1073742336,ce.b,ce.b,[]),s["\u0275mpd"](1073742336,le.e,le.e,[]),s["\u0275mpd"](1073742336,pe.b,pe.b,[]),s["\u0275mpd"](1073742336,me.g,me.g,[]),s["\u0275mpd"](1073742336,me.b,me.b,[]),s["\u0275mpd"](1073742336,he.c,he.c,[]),s["\u0275mpd"](1073742336,ue.b,ue.b,[]),s["\u0275mpd"](1073742336,be.c,be.c,[]),s["\u0275mpd"](1073742336,be.b,be.b,[]),s["\u0275mpd"](1073742336,ge.a,ge.a,[]),s["\u0275mpd"](1073742336,fe.b,fe.b,[]),s["\u0275mpd"](1073742336,ve.g,ve.g,[]),s["\u0275mpd"](1073742336,Ce.b,Ce.b,[]),s["\u0275mpd"](1073742336,_e.a,_e.a,[]),s["\u0275mpd"](1073742336,ye.b,ye.b,[]),s["\u0275mpd"](1073742336,qe.d,qe.d,[]),s["\u0275mpd"](1073742336,Se.a,Se.a,[]),s["\u0275mpd"](1073742336,Fe.h,Fe.h,[]),s["\u0275mpd"](1073742336,Fe.f,Fe.f,[]),s["\u0275mpd"](1073742336,L.w,L.w,[]),s["\u0275mpd"](1073742336,Pe.h,Pe.h,[]),s["\u0275mpd"](1073742336,Pe.d,Pe.d,[]),s["\u0275mpd"](1073742336,Pe.f,Pe.f,[]),s["\u0275mpd"](1073742336,g.g,g.g,[]),s["\u0275mpd"](1073742336,g.e,g.e,[]),s["\u0275mpd"](1073742336,De.a,De.a,[]),s["\u0275mpd"](1073742336,ze.b,ze.b,[]),s["\u0275mpd"](1073742336,we.b,we.b,[]),s["\u0275mpd"](1073742336,Le.c,Le.c,[]),s["\u0275mpd"](1073742336,Oe.c,Oe.c,[]),s["\u0275mpd"](1073742336,Ie.b,Ie.b,[]),s["\u0275mpd"](1073742336,Ne.a,Ne.a,[]),s["\u0275mpd"](1073742336,je.a,je.a,[]),s["\u0275mpd"](1073742336,Ae.b,Ae.b,[]),s["\u0275mpd"](1073742336,Ve.a,Ve.a,[]),s["\u0275mpd"](1073742336,xe.a,xe.a,[]),s["\u0275mpd"](1073742336,Re.c,Re.c,[]),s["\u0275mpd"](1073742336,Te.b,Te.b,[]),s["\u0275mpd"](1073742336,ke.b,ke.b,[]),s["\u0275mpd"](1073742336,He.g,He.g,[]),s["\u0275mpd"](1073742336,Me.a,Me.a,[]),s["\u0275mpd"](1073742336,Be.a,Be.a,[]),s["\u0275mpd"](1073742336,L.B,L.B,[]),s["\u0275mpd"](1073742336,Ee.a,Ee.a,[]),s["\u0275mpd"](1073742336,Ge.a,Ge.a,[]),s["\u0275mpd"](1073742336,Je.a,Je.a,[]),s["\u0275mpd"](1073742336,L.o,L.o,[]),s["\u0275mpd"](1073742336,Ye.a,Ye.a,[]),s["\u0275mpd"](1073742336,Ke.d,Ke.d,[]),s["\u0275mpd"](1073742336,Qe.a,Qe.a,[]),s["\u0275mpd"](1073742336,Ze.a,Ze.a,[]),s["\u0275mpd"](1073742336,$e.a,$e.a,[]),s["\u0275mpd"](1073742336,We.d,We.d,[]),s["\u0275mpd"](1073742336,o.s,o.s,[]),s["\u0275mpd"](1073742336,Ue.a,Ue.a,[]),s["\u0275mpd"](1073742336,n,n,[]),s["\u0275mpd"](1024,A.k,(function(){return[[{path:"receipt",component:b,canActivate:[V.a],data:x}]]}),[]),s["\u0275mpd"](256,Fe.b,{nzAnimate:!0,nzDuration:3e3,nzMaxStack:7,nzPauseOnHover:!0,nzTop:24},[]),s["\u0275mpd"](256,g.b,{nzTop:"24px",nzBottom:"24px",nzPlacement:"topRight",nzDuration:4500,nzMaxStack:7,nzPauseOnHover:!0,nzAnimate:!0},[])])}))}}]);